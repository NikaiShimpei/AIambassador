// CSVデータを読み込んでJavaScriptオブジェクトに変換するスクリプト

// CSVデータ（csList_html.csvから取得）
const csvData = `ID,名前,所属,職名,(性別)
1050013,赤坂太郎1,ピクルス班1,ストプラ職,男性
1050015,赤坂太郎2,ピクルス班2,ストプラ職,男性
1053421,赤坂太郎3,ピクルス班3,ビジデベ職,男性
1054278,赤坂太郎4,ピクルス班4,ストプラ職,男性
1055367,赤坂花子5,ピクルス班5,マネプロ職,女性
1056865,赤坂花子6,ピクルス班6,BP職,女性
1056876,赤坂太郎7,ピクルス班7,BP職,男性
1056878,赤坂太郎8,ピクルス班8,BP職,男性
1056944,赤坂太郎9,ピクルス班9,BP職,男性
1056952,赤坂太郎10,ピクルス班10,BP職,男性
1056953,赤坂太郎11,ピクルス班11,BP職,男性
1056964,赤坂太郎12,ピクルス班12,BP職,男性
1056973,赤坂太郎13,ピクルス班13,BP職,男性
1056974,赤坂花子14,ピクルス班14,BP職,女性
1057042,赤坂花子15,ピクルス班15,BP職,女性
1071666,赤坂花子16,ピクルス班16,メディアプラニング職,女性
1054542,赤坂花子17,ピクルス班17,マネプロ職,女性
1056880,赤坂太郎18,ピクルス班18,BP職,男性
1056881,赤坂太郎19,ピクルス班19,BP職,男性
1056948,赤坂花子20,ピクルス班20,BP職,女性
1056959,赤坂太郎21,ピクルス班21,BP職,男性
1056970,赤坂太郎22,ピクルス班22,BP職,男性
1056971,赤坂花子23,ピクルス班23,BP職,女性
1071476,赤坂花子24,ピクルス班24,メディアプロデュース職,女性
1047134,赤坂太郎25,ピクルス班25,BP職,男性
1047200,赤坂太郎26,ピクルス班26,ストプラ職,男性
1054280,赤坂太郎27,ピクルス班27,ストプラ職,男性
1055834,赤坂花子28,ピクルス班28,ストプラ職,女性
1056753,赤坂花子29,ピクルス班29,クリエイティブ職,女性
1056951,赤坂太郎30,ピクルス班30,BP職,男性
1056961,赤坂花子31,ピクルス班31,BP職,女性
1056966,赤坂太郎32,ピクルス班32,BP職,男性
1056972,赤坂花子33,ピクルス班33,BP職,女性
1071530,赤坂太郎34,ピクルス班34,メディアプラニング職,男性
1051901,赤坂花子35,ピクルス班35,ストプラ職,女性
1051902,赤坂太郎36,ピクルス班36,BP職,男性
1051903,赤坂花子37,ピクルス班37,クリエイティブ職,女性
1051905,赤坂太郎38,ピクルス班38,ストプラ職,男性
1051906,赤坂花子39,ピクルス班39,BP職,女性
1051907,赤坂花子40,ピクルス班40,BP職,女性
1051908,赤坂太郎41,ピクルス班41,BP職,男性
1051909,赤坂太郎42,ピクルス班42,BP職,男性
1051910,赤坂花子43,ピクルス班43,BP職,女性
1051911,赤坂花子44,ピクルス班44,BP職,女性
1051912,赤坂太郎45,ピクルス班45,BP職,男性
1051913,赤坂太郎46,ピクルス班46,ストプラ職,男性
1051914,赤坂太郎47,ピクルス班47,ストプラ職,男性
1051915,赤坂太郎48,ピクルス班48,クリエイティブ職,男性
1051916,赤坂花子49,ピクルス班49,ストプラ職,女性
1051918,赤坂太郎50,ピクルス班50,クリエイティブ職,男性
1051919,赤坂太郎51,ピクルス班51,BP職,男性
1051920,赤坂太郎52,ピクルス班52,ストプラ職,男性
1051921,赤坂太郎53,ピクルス班53,ストプラ職,男性
1051922,赤坂花子54,ピクルス班54,クリエイティブ職,女性
1051923,赤坂花子55,ピクルス班55,BP職,女性
1051924,赤坂花子56,ピクルス班56,マネプロ職,女性
1051925,赤坂花子57,ピクルス班57,マネプロ職,女性
1051926,赤坂花子58,ピクルス班58,ストプラ職,女性
1051929,赤坂太郎59,ピクルス班59,クリエイティブ職,男性
1051930,赤坂太郎60,ピクルス班60,ストプラ職,男性
1051931,赤坂花子61,ピクルス班61,BP職,女性
1051932,赤坂花子62,ピクルス班62,BP職,女性
1051933,赤坂花子63,ピクルス班63,ストプラ職,女性
1051934,赤坂太郎64,ピクルス班64,BP職,男性
1051935,赤坂花子65,ピクルス班65,BP職,女性
1051936,赤坂花子66,ピクルス班66,クリエイティブ職,女性
1051937,赤坂花子67,ピクルス班67,ストプラ職,女性
1051938,赤坂花子68,ピクルス班68,BP職,女性
1051939,赤坂花子69,ピクルス班69,クリエイティブ職,女性
1051940,赤坂太郎70,ピクルス班70,BP職,男性
1051941,赤坂太郎71,ピクルス班71,BP職,男性
1051942,赤坂花子72,ピクルス班72,BP職,女性
1051943,赤坂太郎73,ピクルス班73,BP職,男性
1051945,赤坂太郎74,ピクルス班74,BP職,男性
1051946,赤坂太郎75,ピクルス班75,ストプラ職,男性
1051947,赤坂花子76,ピクルス班76,BP職,女性
1051948,赤坂太郎77,ピクルス班77,BP職,男性
1051949,赤坂花子78,ピクルス班78,BP職,女性
1051950,赤坂花子79,ピクルス班79,BP職,女性
1051951,赤坂花子80,ピクルス班80,BP職,女性
1051952,赤坂太郎81,ピクルス班81,BP職,男性
1051954,赤坂太郎82,ピクルス班82,BP職,男性
1051955,赤坂太郎83,ピクルス班83,研究開発職,男性
1051956,赤坂花子84,ピクルス班84,BP職,女性
1051957,赤坂太郎85,ピクルス班85,BP職,男性
1051958,赤坂太郎86,ピクルス班86,BP職,男性
1051959,赤坂花子87,ピクルス班87,BP職,女性
1051960,赤坂太郎88,ピクルス班88,ストプラ職,男性
1051961,赤坂太郎89,ピクルス班89,クリエイティブ職,男性
1051962,赤坂太郎90,ピクルス班90,BP職,男性
1051963,赤坂花子91,ピクルス班91,クリエイティブ職,女性
1051964,赤坂太郎92,ピクルス班92,マネプロ職,男性
1051965,赤坂太郎93,ピクルス班93,BP職,男性
1051966,赤坂花子94,ピクルス班94,BP職,女性
1051967,赤坂太郎95,ピクルス班95,ストプラ職,男性
1051968,赤坂太郎96,ピクルス班96,研究開発職,男性
1051969,赤坂花子97,ピクルス班97,ストプラ職,女性
1-51970,赤坂花子98,ピクルス班98,BP職,女性
1051971,赤坂花子99,ピクルス班99,ストプラ職,女性
1051972,赤坂花子100,ピクルス班100,BP職,女性
1051973,赤坂花子101,ピクルス班101,BP職,女性
1051974,赤坂太郎102,ピクルス班102,BP職,男性
1051975,赤坂太郎103,ピクルス班103,BP職,男性
1051976,赤坂花子104,ピクルス班104,ＰＲ職,女性
1051977,赤坂太郎105,ピクルス班105,ストプラ職,男性
1051978,赤坂太郎106,ピクルス班106,BP職,男性
1051979,赤坂太郎107,ピクルス班107,BP職,男性
1051980,赤坂太郎108,ピクルス班108,クリエイティブ職,男性
1051981,赤坂花子109,ピクルス班109,BP職,女性
1051982,赤坂太郎110,ピクルス班110,BP職,男性
1051984,赤坂花子111,ピクルス班111,ＰＲ職,女性
1051985,赤坂太郎112,ピクルス班112,BP職,男性
1051986,赤坂花子113,ピクルス班113,BP職,女性
1051987,赤坂花子114,ピクルス班114,研究開発職,女性
1051988,赤坂花子115,ピクルス班115,BP職,女性
1051989,赤坂太郎116,ピクルス班116,BP職,男性
1051990,赤坂花子117,ピクルス班117,BP職,女性
1051991,赤坂太郎118,ピクルス班118,BP職,男性
1051992,赤坂太郎119,ピクルス班119,BP職,男性
1051993,赤坂太郎120,ピクルス班120,BP職,男性
1051994,赤坂太郎121,ピクルス班121,BP職,男性
1051995,赤坂太郎122,ピクルス班122,BP職,男性
1051996,赤坂太郎123,ピクルス班123,研究開発職,男性
1051997,赤坂太郎124,ピクルス班124,BP職,男性
1057045,赤坂花子125,ピクルス班125,マネプロ職,女性
1071585,赤坂花子126,ピクルス班126,メディアプロデュース職,女性
1071587,赤坂花子127,ピクルス班127,ビジデベ職,女性
1071588,赤坂花子128,ピクルス班128,メディアプロデュース職,女性
1071589,赤坂太郎129,ピクルス班129,メディアプロデュース職,男性
1071590,赤坂太郎130,ピクルス班130,メディアプロデュース職,男性
1071591,赤坂花子131,ピクルス班131,メディアプロデュース職,女性
1071593,赤坂花子132,ピクルス班132,メディアプラニング職,女性
1071594,赤坂太郎133,ピクルス班133,ビジデベ職,男性
1071595,赤坂花子134,ピクルス班134,メディアプロデュース職,女性
1071596,赤坂太郎135,ピクルス班135,メディアプラニング職,男性
1071597,赤坂花子136,ピクルス班136,マネプロ職,女性
1071598,赤坂花子137,ピクルス班137,メディアプロデュース職,女性
1071599,赤坂太郎138,ピクルス班138,メディアプロデュース職,男性
1071600,赤坂花子139,ピクルス班139,メディアプラニング職,女性
1071601,赤坂太郎140,ピクルス班140,メディアプロデュース職,男性
1071602,赤坂太郎141,ピクルス班141,メディアプロデュース職,男性
1071604,赤坂花子142,ピクルス班142,メディアプロデュース職,女性
1071605,赤坂太郎143,ピクルス班143,メディアプロデュース職,男性
1071606,赤坂太郎144,ピクルス班144,メディアプロデュース職,男性
1071607,赤坂花子145,ピクルス班145,メディアプロデュース職,女性
1071608,赤坂太郎146,ピクルス班146,メディアプロデュース職,男性
1071609,赤坂花子147,ピクルス班147,メディアプロデュース職,女性
1071610,赤坂太郎148,ピクルス班148,ビジデベ職,男性
1071611,赤坂花子149,ピクルス班149,メディアプロデュース職,女性
1071613,赤坂太郎150,ピクルス班150,メディアプロデュース職,男性
1071615,赤坂花子151,ピクルス班151,メディアプラニング職,女性
1071616,赤坂太郎152,ピクルス班152,メディアプロデュース職,男性
1071617,赤坂太郎153,ピクルス班153,メディアプロデュース職,男性
1071618,赤坂花子154,ピクルス班154,メディアプラニング職,女性
1071619,赤坂花子155,ピクルス班155,メディアプロデュース職,女性
1071620,赤坂太郎156,ピクルス班156,メディアプロデュース職,男性
1071863,赤坂太郎157,ピクルス班157,マネプロ職,男性
1071872,赤坂太郎158,ピクルス班158,ビジデベ職,男性
1071895,赤坂太郎159,ピクルス班159,メディアプロデュース職,男性
1071905,赤坂太郎160,ピクルス班160,メディアプラニング職,男性
1071907,赤坂太郎161,ピクルス班161,メディアプラニング職,男性
`;

// CSVをパースしてJavaScriptオブジェクトに変換
function parseCSV(csv) {
    const lines = csv.split('\n');
    const headers = lines[0].split(',');
    const data = [];
    
    for (let i = 1; i < lines.length; i++) {
        if (lines[i].trim() === '') continue;
        
        const values = lines[i].split(',');
        const obj = {};
        
        headers.forEach((header, index) => {
            obj[header.trim()] = values[index] ? values[index].trim() : '';
        });
        
        data.push(obj);
    }
    
    return data;
}

// データを変換
const personData = parseCSV(csvData);

// グローバル変数として利用可能にする
window.personData = personData;

// Calip_data.txtの詳細データを読み込む関数
async function loadDetailedData() {
    try {
        const response = await fetch('Calip_data_downloaded.txt');
        const text = await response.text();
        
        // テキストを個人ごとに分割
        const profiles = text.split('【Career Stretch Program（CSP）個別プロフィール】').filter(p => p.trim());
        
        const detailedData = {};
        
        profiles.forEach(profile => {
            const lines = profile.trim().split('\n');
            const idMatch = lines[0].match(/No\.\s*(\d+)/);
            const nameMatch = lines[1].match(/氏名：\s*(.+)/);
            
            if (idMatch && nameMatch) {
                const id = idMatch[1];
                const name = nameMatch[1].trim();
                detailedData[id] = {
                    id: id,
                    name: name,
                    fullProfile: profile.trim()
                };
            }
        });
        
        window.detailedData = detailedData;
        console.log('詳細データ読み込み完了:', Object.keys(detailedData).length, '件');
        
        return detailedData;
    } catch (error) {
        console.error('詳細データの読み込みに失敗しました:', error);
        return {};
    }
}

// ページ読み込み時に詳細データを読み込む
document.addEventListener('DOMContentLoaded', function() {
    loadDetailedData();
});

console.log('データ読み込み完了:', personData.length, '件'); 
